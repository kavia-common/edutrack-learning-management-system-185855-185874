{"is_source_file": true, "format": "Python", "description": "This file defines service functions for an educational management system, including user authentication, enrollment, payment processing via Stripe, certificate generation, notifications, and quiz grading.", "external_files": ["stripe", "flask", "reportlab.lib.pagesizes", "reportlab.pdfgen.canvas", ".models", ".security", ".db"], "external_methods": ["stripe.PaymentIntent.create", "current_app.config.get", "stripe.api_key", "User.query.filter_by", "Role.query.filter_by", "db.session.add", "db.session.flush", "db.session.commit", "Notification.query.filter_by", "canvas.Canvas", "datetime.utcnow"], "published": ["init_stripe_from_config", "authenticate_user", "create_user", "enroll_user_in_course", "create_payment_intent", "mark_payment_succeeded", "generate_certificate_pdf_bytes", "record_notification", "grade_quiz"], "classes": [{"name": "User", "description": "Represents a user in the system with attributes like email, full_name, password_hash, and role."}, {"name": "Role", "description": "Defines roles assigned to users, such as 'student' or 'instructor'."}, {"name": "Course", "description": "Represents a course offered in the system."}, {"name": "Enrollment", "description": "Tracks user enrollment in courses, including status."}, {"name": "Payment", "description": "Records payment details, status, and Stripe intent ID."}, {"name": "Notification", "description": "Stores notification messages for users."}, {"name": "Quiz", "description": "Represents a quiz with associated questions."}, {"name": "Question", "description": "Contains question details and correct option for grading."}, {"name": "QuizOption", "description": "Possible options for quiz questions."}, {"name": "Submission", "description": "User submissions for quiz questions."}], "methods": [{"name": "init_stripe_from_config()", "description": "Initializes Stripe SDK with secret key from app configuration.", "scope": "", "scopeKind": ""}, {"name": "Optional[User] authenticate_user(email: str, password: str)", "description": "Verifies user credentials and returns user object if valid.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[User],Optional[str]] create_user(email: str, password: str, full_name: str, role_name: str = \"student\")", "description": "Creates a new user account with a specified role.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[Enrollment],Optional[str]] enroll_user_in_course(user_id: int, course_id: int)", "description": "Enrolls a user in a course if not already enrolled.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[str],Optional[str]] create_payment_intent(user_id: int, course_id: int, amount_cents: int, currency: str = \"usd\")", "description": "Creates a Stripe payment intent and records payment info in the database.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] mark_payment_succeeded(payment_intent_id: str)", "description": "Marks a payment as succeeded and auto-enrolls the user.", "scope": "", "scopeKind": ""}, {"name": "bytes generate_certificate_pdf_bytes(student_name: str, course_title: str, issuer: str)", "description": "Generates a certificate PDF and returns it as bytes.", "scope": "", "scopeKind": ""}, {"name": "Notification record_notification(user_id: int, message: str)", "description": "Creates and persists a notification message for a user.", "scope": "", "scopeKind": ""}, {"name": "int grade_quiz(quiz: Quiz, answers: dict[int, int])", "description": "Grades a quiz based on provided answers and questions.", "scope": "", "scopeKind": ""}], "calls": ["stripe.PaymentIntent.create", "current_app.config.get", "stripe.api_key", "User.query.filter_by", "Role.query.filter_by", "db.session.add", "db.session.flush", "db.session.commit", "Notification.query.filter_by", "canvas.Canvas", "datetime.utcnow"], "search-terms": ["Stripe payment", "PDF certificate generation", "user enrollment", "quiz grading", "notifications", "payment intent creation"], "state": 2, "file_id": 9, "knowledge_revision": 20, "git_revision": "", "ctags": [{"_type": "tag", "name": "authenticate_user", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def authenticate_user(email: str, password: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(email: str, password: str)"}, {"_type": "tag", "name": "create_payment_intent", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def create_payment_intent(user_id: int, course_id: int, amount_cents: int, currency: str = \"usd\"/", "language": "Python", "typeref": "typename:Tuple[Optional[str],Optional[str]]", "kind": "function", "signature": "(user_id: int, course_id: int, amount_cents: int, currency: str = \"usd\")"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def create_user(email: str, password: str, full_name: str, role_name: str = \"student\") -> Tuple[/", "language": "Python", "typeref": "typename:Tuple[Optional[User],Optional[str]]", "kind": "function", "signature": "(email: str, password: str, full_name: str, role_name: str = \"student\")"}, {"_type": "tag", "name": "enroll_user_in_course", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def enroll_user_in_course(user_id: int, course_id: int) -> Tuple[Optional[Enrollment], Optional[/", "language": "Python", "typeref": "typename:Tuple[Optional[Enrollment],Optional[str]]", "kind": "function", "signature": "(user_id: int, course_id: int)"}, {"_type": "tag", "name": "generate_certificate_pdf_bytes", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def generate_certificate_pdf_bytes(student_name: str, course_title: str, issuer: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(student_name: str, course_title: str, issuer: str)"}, {"_type": "tag", "name": "grade_quiz", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def grade_quiz(quiz: Quiz, answers: dict[int, int]) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(quiz: Quiz, answers: dict[int, int])"}, {"_type": "tag", "name": "init_stripe_from_config", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def init_stripe_from_config():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "mark_payment_succeeded", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def mark_payment_succeeded(payment_intent_id: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(payment_intent_id: str)"}, {"_type": "tag", "name": "record_notification", "path": "/home/kavia/workspace/code-generation/edutrack-learning-management-system-185855-185874/lms_backend/app/services.py", "pattern": "/^def record_notification(user_id: int, message: str) -> Notification:$/", "language": "Python", "typeref": "typename:Notification", "kind": "function", "signature": "(user_id: int, message: str)"}], "hash": "d7ff0e263a1cd117a549adf8dd5ebdf3", "format-version": 4, "code-base-name": "lms_backend", "filename": "lms_backend/app/services.py", "revision_history": [{"20": ""}]}